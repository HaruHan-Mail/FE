server {
    listen 80;

    # 모든 요청에 대해 /usr/share/nginx/html 디렉토리에서 파일을 찾습니다.
    root /usr/share/nginx/html;
    index index.html;

    # Gzip 압축 활성화
    gzip on;
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss;

    # SPA(Single Page Application)를 위한 설정
    # 요청된 URI가 파일이나 디렉토리로 존재하지 않으면 index.html을 반환합니다.
    location / {
        try_files $uri $uri/ /index.html;
        # index.html은 캐시하지 않도록 설정
        add_header Cache-Control 'no-cache, no-store, must-revalidate';
    }

    # 이름에 해시가 포함된 정적 파일들에 대한 캐시 정책
    # js, css, 이미지 등은 내용이 바뀌면 파일 이름도 바뀌므로 길게 캐싱합니다.
    location ~* \.(?:css|js|jpg|jpeg|gif|png|ico|webp|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
} 